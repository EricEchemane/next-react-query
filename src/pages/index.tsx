import Head from 'next/head';
import { Inter } from 'next/font/google';
import { useQuery } from 'react-query';
import { Todo } from '@/interfaces/todo.int';

const inter = Inter({ subsets: ['latin'] });

export default function Home() {
	const todos = useQuery('todos', () =>
		fetch('/api/todos').then((res) => res.json())
	);

	const hasTodos = todos.data?.length > 0;

	return (
		<>
			<Head>
				<title>Create Next App</title>
				<meta
					name='description'
					content='Generated by create next app'
				/>
				<meta
					name='viewport'
					content='width=device-width, initial-scale=1'
				/>
				<link
					rel='icon'
					href='/favicon.ico'
				/>
			</Head>

			<main className={inter.className}>
				<h1>Todos</h1>

				{todos.isLoading ? (
					<p>Loading...</p>
				) : (
					<ul>
						{hasTodos &&
							todos.data.map((todo: Todo) => (
								<li key={todo.id}>{todo.title}</li>
							))}
						{!hasTodos && <li>No todos yet</li>}
					</ul>
				)}
			</main>
		</>
	);
}
